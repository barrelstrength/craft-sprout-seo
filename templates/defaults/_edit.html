{% extends "sproutseo/_layouts/base" %}
{% set centered = true %}

{% set title %}
	New Default - {{ craft.SproutSeo.name }}
{% endset %}

{% set tabs = {
		default: {
			label: "Settings"|t,
			url: '#default-main'
		},
		main: {
			label: "Basic Info"|t,
			url: '#default-basic'
		},
		publishinfo:    {
			label: "Robots"|t,
			url: '#default-robots'
		},
		location:    {
			label: "Location"|t,
			url: '#default-location'
		},
		facebook:    {
			label: "Facebook"|t,
			url: '#default-facebook'
		},
		twitter:    {
			label: "Twitter"|t,
			url: '#default-twitter'
		}
} %}

{% import "_includes/forms" as forms %}

{# Set a field context so we can manage field visibility between the SEO Defaults and the Field Types #}
{% set fieldContext = 'defaults' %}

{# Map the `defaults` object to `values` so we can use the same tempaltes for SEO Defaults and the Field Types #}
{% set values = default %}

{% set body %}

{% if craft.request.getSegment(3) == 'new' %}
	{% set saveshortcutUrl = url('sproutseo/defaults') %}
{% else %}
  {% set saveshortcutUrl = url('sproutseo/defaults/' ~ defaultId) %}
{% endif %}

<form method="post" action="" accept-charset="UTF-8" data-saveshortcut="1" data-saveshortcut-redirect="{{ saveshortcutUrl }}">
	{{ getCsrfInput() }}
	<input type="hidden" name="action" value="sproutSeo/defaults/saveDefault">
	<input type="hidden" name="redirect" value="sproutseo/defaults">

	<input type="hidden" name="sproutseo_fields[id]" value="{{ defaultId }}">

<div id="default-main">

	{{ forms.textField({
		label: "Name"|t,
		instructions: "Human readable default name"|t,
		id: "name",
		name: 'sproutseo_fields[name]',
		value: default.name,
		errors: '',
		required: true
	}) }}

	{{ forms.textField({
		label: "Short Name"|t,
		instructions: "Short name you will use to refer to your defaults in the code"|t,
		id: "handle",
		name: 'sproutseo_fields[handle]',
		value: default.handle,
		errors: '',
		required: true
	}) }}

	{% set canBeGlobalFallback = craft.sproutSeo.displayGlobalFallback(defaultId) %}

	{% if canBeGlobalFallback %}
		{{ forms.checkboxField({
			label: "Use this default as my global fallback"|t,
			id: 'global-fallback',
			name: 'sproutseo_fields[globalFallback]',
			checked: default.globalFallback
		}) }}
	{% endif %}

</div>

<div id="default-basic" class="hidden">

	{% include 'sproutseo/_partials/fields/input' %}

</div>

<div id="default-robots" class="hidden">

	{% include 'sproutseo/_partials/fields/robots' %}

</div>

<div id="default-location" class="hidden">

	{{ forms.textField({
		label: "Region",
		instructions: 'The geo.region expects codes for <a
	  href="http://geotags.com/iso3166/countries.html" target="_blank">Country Names and Subdivisions</a>. The <a
	  href="http://geotags.com/geo/DMS3.html" target="_blank">GeoTag Generator</a> can help pick appropriate codes.',
		name: "sproutseo_fields[region]",
		value: default.region
	}) }}

	{{ forms.textField({
		label: "Placename",
		instructions: "The Placename field is typically used for city, county, and state names.",
		name: "sproutseo_fields[placename]",
		value: default.placename
	}) }}

	{{ forms.textField({
		label: "Latitude",
		name: "sproutseo_fields[latitude]",
		value: default.latitude,
		placeholder: '38.403440'
	}) }}

	{{ forms.textField({
		label: "Longitude",
		name: "sproutseo_fields[longitude]",
		value: default.longitude,
		placeholder: '-122.823676'
	}) }}

</div>

<div id="default-facebook" class="hidden">

	{% set ogTypesOptions = {
		'' : 'Select Open Graph Type...',
		'article' : 'Article',
		'website' : 'Website',
	} %}

	<h2>Facebook Open Graph Meta Data</h2>

	{{ forms.selectField({
		label: 'Open Graph Type',
		instructions: 'First, select your Open Graph Type. Learn more about <a href="https://developers.facebook.com/docs/reference/opengraph#object-type"
		target="_blank">How Open Graph Stories work.</a>',
		name: 'sproutseo_fields[ogType]',
		options: ogTypesOptions,
		value: default.ogType,
		errors: "",
		required: false
	}) }}

	<hr />

	<h2>Basic Metadata</h2>

	{{ forms.textField({
		label: "Title"|t,
		name: 'sproutseo_fields[ogTitle]',
		instructions: "The title of your content as it should appear within the graph",
		maxlength: 88,
		showCharsLeft: true,
		value: default.ogTitle,
		errors: "",
		required: false,
		placeholder: " "
	}) }}

	{{ forms.textField({
		label: "URL"|t,
		instructions: "The canonical URL of your content that will be used as its permanent ID in the graph.",
		name: 'sproutseo_fields[ogUrl]',
		value: default.ogUrl,
		errors: "",
		required: false
	}) }}

	{% if assetsSourceExists %}
		{{ forms.field({
			label: 'Image',
			}, forms.elementSelect({
			elements: ogImageElements,
			sourceElementId: default.ogImage,
			elementType: elementType,
			id: 'ogImage',
			name: 'sproutseo_fields[ogImage]',
			jsClass: 'Craft.AssetSelectInput',
			addButtonLabel: 'Select Image',
			limit: 1,
			criteria: {"localeEnabled":null}
		})) }}
	{% else %}
		<p class="error">No assets sources currently exist. <a href="{{ url('settings/assets/sources/new') }}">Asset Source settings page.</a></p>
	{% endif %}

	<hr />

	<h2>Optional Metadata</h2>

	<div id="facebook-article" class="hidden">

		{{ forms.textField({
			label: "Publisher"|t,
			name: 'sproutseo_fields[ogPublisher]',
			instructions: "A Facebook page URL or ID of the publishing entity",
			value: default.ogPublisher,
			errors: "",
			required: false
		}) }}

		{{ forms.textField({
			label: "Author"|t,
			name: 'sproutseo_fields[ogAuthor]',
			instructions: "An array of Facebook profile URLs or IDs of the authors for this article (separate multiple profiles with a comma)",
			value: default.ogAuthor,
			errors: "",
			required: false
		}) }}

	</div>

	{{ forms.textField({
		label: "Site Name"|t,
		instructions: "If your content is part of a larger web site, the name which should be displayed for the overall site.",
		name: 'sproutseo_fields[ogSiteName]',
		value: default.ogSiteName,
		errors: "",
		required: false
	}) }}

	{{ forms.textField({
		label: "Description"|t,
		name: 'sproutseo_fields[ogDescription]',
		maxlength: 200,
		showCharsLeft: true,
		value: default.ogDescription,
		errors: "",
		required: false,
		placeholder: " "
	}) }}

	{{ forms.textField({
		label: "Locale"|t,
		instructions: "The locale these tags are marked up in. Default is en_us.",
		name: 'sproutseo_fields[ogLocale]',
		value: default.ogLocale,
		errors: "",
		required: false
	}) }}

	{{ forms.textField({
		label: "Audio"|t,
		instructions: "A URL to an audio file to accompany this content.",
		name: 'sproutseo_fields[ogAudio]',
		value: default.ogAudio,
		errors: "",
		required: false
	}) }}

	{{ forms.textField({
		label: "Video"|t,
		instructions: "A URL to a video file that complements this content.",
		name: 'sproutseo_fields[ogVideo]',
		value: default.ogVideo,
		errors: "",
		required: false
	}) }}

	<hr>

</div>

<div id="default-twitter" class="hidden">

	{% set twitterCardOptions = {
		'' : 'Select Twitter Card Type...',
		'summary' : 'Summary Card',
		'summary-large-image' : 'Summary Card with Large Image',
		'player' : 'Player Card',
		'photo' : 'Photo Card',
	} %}

	<h2>Twitter Card Meta Data</h2>

	{{ forms.selectField({
		label: 'Twitter Card Type',
		instructions: 'First, select your Twitter Card Type. Learn more about <a href="https://dev.twitter.com/docs/cards"
		target="_blank">How Twitter Cards work</a>.',
		name: 'sproutseo_fields[twitterCard]',
		options: twitterCardOptions,
		value: (default.twitterCard is defined ? default.twitterCard : 'summary'),
		value: default.twitterCard,
		errors: "",
		required: false
	}) }}

	<hr>

	<h2>Global Card Options</h2>

	{{ forms.textField({
		label: "Site"|t,
		name: 'sproutseo_fields[twitterSite]',
		instructions: "The Twitter username of the owner of this card's domain.",
		value: default.twitterSite,
		errors: "",
		required: false,
		placeholder: '@ContentPublisher'
	}) }}

	{{ forms.textField({
		label: "Creator"|t,
		name: 'sproutseo_fields[twitterCreator]',
		instructions: "If the content of this card was authored by someone, include their Twitter username here.",
		value: default.twitterCreator,
		errors: "",
		required: false,
		placeholder: '@ContentAuthor'
	}) }}

	{{ forms.textField({
		label: "Title"|t,
		name: 'sproutseo_fields[twitterTitle]',
		instructions: 'The title of your content as it should appear in the card.',
		maxlength: 70,
		showCharsLeft: true,
		value: default.twitterTitle,
		errors: "",
		required: false,
		placeholder: " "
	}) }}

	{{ forms.textField({
		label: "Description"|t,
		name: 'sproutseo_fields[twitterDescription]',
		instructions: 'A description of the content.',
		maxlength: 200,
		showCharsLeft: true,
		value: default.twitterDescription,
		errors: "",
		required: false,
		placeholder: " "
	}) }}

	{% if assetsSourceExists %}
		{{ forms.field({
			label: 'Image',
			}, forms.elementSelect({
			elements: twitterImageElements,
			sourceElementId: default.twitterImage,
			elementType: elementType,
			id: 'twitterImage',
			name: 'sproutseo_fields[twitterImage]',
			jsClass: 'Craft.AssetSelectInput',
			addButtonLabel: 'Select Image',
			limit: 1,
			criteria: {"localeEnabled":null}
		})) }}
	{% else %}
		<p class="error">No assets sources currently exist. <a href="Create one on the {{ url('settings/assets/sources/new') }}">Asset Source settings page.</a></p>
	{% endif %}

	<div id="twitter-player" class="hidden">

		<h2>Player Card Specific</h2>

		{{ forms.textField({
			label: "Player"|t,
			name: 'sproutseo_fields[twitterPlayer]',
			instructions: "HTTPS URL to iframe player. This must be a HTTPS URL which does not generate mixed content warnings in a web browser.",
			value: default.twitterPlayer,
			errors: "",
			required: false
		}) }}

		{{ forms.textField({
			label: "Stream"|t,
			name: 'sproutseo_fields[twitterPlayerStream]',
			instructions: "URL to raw stream that will be rendered in Twitter's Mobile App Integrations directly. If provided, the stream must be delivered in the MPEG-4 container format.",
			value: default.twitterPlayerStream,
			errors: "",
			required: false
		}) }}

		{{ forms.textField({
			label: "Stream Content Type"|t,
			name: 'sproutseo_fields[twitterPlayerStreamContentType]',
			instructions: "The MIME type subtype combination that describes the content contained in twitter player stream.",
			value: default.twitterPlayerStreamContentType,
			errors: "",
			required: false
		}) }}

		{{ forms.textField({
			label: "Height"|t,
			name: 'sproutseo_fields[twitterPlayerHeight]',
			instructions: "Height of IFRAME specified in twitter player in pixels.",
			value: default.twitterPlayerHeight,
			errors: "",
			required: false
		}) }}

		{{ forms.textField({
			label: "Width"|t,
			name: 'sproutseo_fields[twitterPlayerWidth]',
			instructions: 'Width of IFRAME specified in twitter player in pixels.',
			value: default.twitterPlayerWidth,
			errors: "",
			required: false
		}) }}

		<hr />

	</div>

</div>

<div class="buttons">
	<input class="btn submit" type="submit" value="Save Default">
</div>

</form>

{% endset %}

{% if default.name is not defined or not default.handle %}
	{% includeJs "new Craft.HandleGenerator('#name', '#handle');" %}
{% endif %}

{% includeJsResource "sproutseo/js/default.js" %}

{% set js %}

	new Craft.SproutSeoDefault();

{% endset %}

{% includeJs js %}
