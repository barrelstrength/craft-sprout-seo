{% extends "sproutseo/_layout" %}
{% import "_includes/forms" as forms %}

{% set selectedTab = 'sitemap' %}

{% set body %}

<form method="post" action="" accept-charset="UTF-8" data-saveshortcut="1" data-saveshortcut-redirect="{{ craft.request.url }}">
	<input type="hidden" name="action" value="sproutSeo/sitemap/saveSitemap"> 
	<input type="hidden" name="redirect" value="sproutseo/sitemap">

{# <h3>Your Sitemap URL</h3>
<p class="instructions">This is the location that your sitemap file will be saved.</p>
<p><input type="text" style="width:96%;padding:10px;" value="{{ siteUrl }}/sitemap.xml"></p> #}

<h3>Sections</h3>

<p>All of your sections that have unique URLs are listed here.  Enable each section you want to include in your sitemap.</p>

{% set priorityList = {
	'1.0': '1.0 ↑ Highest',
	'0.9': '0.9',
	'0.8': '0.8',
	'0.7': '0.7',
	'0.6': '0.6',
	'0.5': '0.5',
	'0.4': '0.4',
	'0.3': '0.3',
	'0.2': '0.2',
	'0.1': '0.1',
	'0.0': '0.0 ↓ Lowest'
} %}

{% set frequencyList = {
	'always': 'Always',
	'hourly': 'Hourly',
	'daily': 'Daily',
	'weekly': 'Weekly',
	'monthly': 'Monthly',
	'yearly': 'Yearly',
	'never': 'Never'
} %}

{% macro isSelected(target) %}
	{% if target %}checked="checked"{% endif %}
{% endmacro %}
{% import _self as checkbox %}


<table class="data fullwidth sitemap-settings">
	<thead>
		<th>Standalone Page URL</th>
		<th>Priority</th>
		<th>Change Frequency</th>
		<th>Enabled</th>
		<th>Ping on Save</th>
	</thead>
	<tbody>

	{% for section in craft.sproutSeo.getAllSectionsWithUrls() %}

		{% set sitemap = null %}
		{% if section.settings is defined %}
			{% set sitemap = section.settings %}
		{% endif %}

		<tr data-sectionid="{{ section.id }}">
			<td>
				<strong>{{ section.name }}</strong>

				{% if section.settings is defined %}
			{{ section.settings.enabled }} | {{ section.settings.ping }}
		{% endif %}
			</td>
			<td>
				{{ forms.selectField({
					name: 'sitemap_fields[' ~ section.id ~ '][priority]',
					options: priorityList,
					value: (sitemap.priority is defined ? sitemap.priority : 0.5),
					errors: "",
					required: false
				}) }}
			</td>
			<td>
				{{ forms.selectField({
					name: 'sitemap_fields[' ~ section.id ~ '][changeFrequency]',
					options: frequencyList,
					value: (sitemap.changeFrequency is defined ? sitemap.changeFrequency : 'weekly'),
					errors: "",
					required: false
				}) }}
			</td>
			<td>
				<input type="checkbox" name="sitemap_fields[{{ section.id }}][enabled]" {{ checkbox.isSelected((sitemap.enabled is defined and sitemap.enabled == 1) ? true : false) }}>
			</td>
			<td>
				<input type="checkbox" name="sitemap_fields[{{ section.id }}][ping]" {{ checkbox.isSelected((sitemap.ping is defined and sitemap.ping == 1) ? true : false) }}>
			</td>
		</tr>
	
	{% endfor %}

	</tbody>
</table>


{# <h3>Standalone Pages</h3>

<p>If you have pages on your site that you want to include in your sitemap that are not dynamically generated by sections, you can manually create those sections here.</p>

<table class="data">
	<thead>
		<th>Standalone Page URL</th>
		<th>Priority</th>
		<th>Change Frequency</th>
		<th>Enabled</th>
		<th>Delete</th>
	</thead>
	<tbody>
		<tr>
			<td><input type="text"></td>
			<td>
				<select>
					<option value="">1.0 &uarr; Highest</option>
					<option value="" selected="selected">0.5</option>
					<option value="">0.1 &darr; Lowest</option>
				</select>
			</td>
			<td>
				<select>
					<option value="">Daily</option>
					<option value="">Weekly</option>
					<option value="">Monthly</option>
				</select>
			</td>
			<td>
				<input type="checkbox">
			</td>
			<td>
				<a class="delete icon" title="Delete"></a>
			</td>
		</tr>
	</tbody>
</table>

<div class="buttons"><a class="btn submit add icon small" style="background-color: blue;" href="{{ url('sproutseo/templates/new') }}">New Standalone Page</a>
</div> #}

<p>Priority: The priority of this URL relative to other URLs on your site. Valid values range from 0.0 to 1.0. This value does not affect how your pages are compared to pages on other sites—it only lets the search engines know which pages you deem most important for the crawlers.</p>

<p>Frequency: The value "always" should be used to describe documents that change each time they are accessed. The value "never" should be used to describe archived URLs.</p>

</form>

{% endset %}

{% includeJsResource "sproutseo/js/sitemap.js" %}

{% set js %}
	new Craft.SproutSeoSitemap();
{% endset %}

{% includeJs js %}